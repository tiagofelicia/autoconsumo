=== FASE 1 (MIBEL CSV) INICIADA: Mon Nov 17 10:58:56 UTC 2025 ===
‚úÖ Bibliotecas carregadas para [Atualizador de MIBEL_ano_atual_ACUM]
üöÄ A iniciar a atualiza√ß√£o do ficheiro hist√≥rico `MIBEL_atual_ACUM.csv`...

   - 1: A ler hist√≥rico local...
     - ‚úÖ 'data/MIBEL_ano_atual_ACUM.csv' lido com sucesso (30816 registos).

   - 2: √öltima data local: 2025-11-17. A preencher buracos com OMIE Di√°rio desde 2025-11-18...
   - ‚ÑπÔ∏è O hist√≥rico local j√° est√° atualizado. A saltar OMIE Di√°rio.

   - 3: A obter dados da OMIE (ACUM/INDICADORES)...
   - ‚ÑπÔ∏è [OMIE] A tentar extrair dados recentes (ACUM, INDICADORES)...
     - [OMIE] A ler dados (ACUM)...
     - [OMIE] A ler dados (INDICADORES)...
   - ‚úÖ [OMIE] 288 registos recentes extra√≠dos.

   - 4: A combinar e limpar dados...

‚úÖ SUCESSO: 'data/MIBEL_ano_atual_ACUM.csv' foi atualizado com sucesso.
   - Total de registos guardados: 30816
=== FASE 1 (MIBEL CSV) TERMINADA: Mon Nov 17 10:58:58 UTC 2025 ===
=== FASE 2 (AUTOCONSUMO) IGNORADA (Sem Mudan√ßas na Fase 1): Mon Nov 17 10:58:58 UTC 2025 ===
=== FASE 1 (MIBEL CSV) INICIADA: Mon Nov 17 12:22:34 UTC 2025 ===
‚úÖ Bibliotecas carregadas para [Atualizador de MIBEL_ano_atual_ACUM]
üöÄ A iniciar a atualiza√ß√£o do ficheiro hist√≥rico `MIBEL_atual_ACUM.csv`...

   - 1: A ler hist√≥rico local...
     - ‚úÖ 'data/MIBEL_ano_atual_ACUM.csv' lido com sucesso (30816 registos).

   - 2: √öltima data local: 2025-11-17. A preencher buracos com OMIE Di√°rio desde 2025-11-18...
   - ‚ÑπÔ∏è O hist√≥rico local j√° est√° atualizado. A saltar OMIE Di√°rio.

   - 3: A obter dados da OMIE (ACUM/INDICADORES)...
   - ‚ÑπÔ∏è [OMIE] A tentar extrair dados recentes (ACUM, INDICADORES)...
     - [OMIE] A ler dados (ACUM)...
     - [OMIE] A ler dados (INDICADORES)...
   - ‚úÖ [OMIE] 288 registos recentes extra√≠dos.

   - 4: A combinar e limpar dados...

‚úÖ SUCESSO: 'data/MIBEL_ano_atual_ACUM.csv' foi atualizado com sucesso.
   - Total de registos guardados: 30912
=== FASE 1 (MIBEL CSV) TERMINADA: Mon Nov 17 12:22:36 UTC 2025 ===
=== FASE 2 (AUTOCONSUMO) INICIADA (Houve Mudan√ßas): Mon Nov 17 12:22:37 UTC 2025 ===
‚úÖ Bibliotecas carregadas
‚ÑπÔ∏è Fonte de dados: 'data/MIBEL_ano_atual_ACUM.csv'
‚ö†Ô∏è MODO: Apenas dados reais (sem futuros)

‚è≥ Passo 1: A ler dados hist√≥ricos do 'data/MIBEL_ano_atual_ACUM.csv'...
‚úÖ 30912 registos hist√≥ricos (com dados) lidos.
   üìÖ √öltima data com dados: 2025-11-18

‚è≥ Passo 2: A criar estrutura completa at√© 2026...
   - Dados reais at√©: 2025-11-18
   - Estrutura criada at√©: 2025-12-31
   - Registos com dados reais: 30912
   - Registos vazios (futuros): 4128

‚è≥ Passo 3: A converter para hora de Portugal...
‚úÖ 35036 registos totais preparados em hora de Portugal.
   - Com dados reais: 30908
   - Vazios (NaN): 4128
‚úÖ Todos os dias t√™m n√∫mero de quartos esperado (92, 96 ou 100).

‚è≥ Passo 4: A atualizar o ficheiro 'Simulador_‚òÄÔ∏è_Autoconsumo_Tiago_Felicia.xlsx'...
   - A ler a pauta de tempo da aba 'OMIE_CICLOS' para alinhamento...
   - A alinhar pre√ßos calculados com a pauta do Excel...
   - 35036 pre√ßos (2025/2026) alinhados e prontos a escrever.
   - A carregar 'Simulador_‚òÄÔ∏è_Autoconsumo_Tiago_Felicia.xlsx' para escrita...
   - A escrever 35036 pre√ßos na Coluna 8 (H)...
‚úÖ O ficheiro Excel foi atualizado com sucesso!
   Data_Valores_OMIE = 2025-11-18
   ‚ö†Ô∏è Nota: Apenas dados reais at√© 2025-11-18 foram escritos.
=== FASE 2 (AUTOCONSUMO) TERMINADA: Mon Nov 17 12:23:09 UTC 2025 ===
=== FASE 1 (MIBEL CSV) INICIADA: Mon Nov 17 13:30:43 UTC 2025 ===
‚úÖ Bibliotecas carregadas para [Atualizador de MIBEL_ano_atual_ACUM]
üöÄ A iniciar a atualiza√ß√£o do ficheiro hist√≥rico `MIBEL_atual_ACUM.csv`...

   - 1: A ler hist√≥rico local...
     - ‚úÖ 'data/MIBEL_ano_atual_ACUM.csv' lido com sucesso (30912 registos).

   - 2: √öltima data local: 2025-11-18. A preencher buracos com OMIE Di√°rio desde 2025-11-19...
   - ‚ÑπÔ∏è O hist√≥rico local j√° est√° atualizado. A saltar OMIE Di√°rio.

   - 3: A obter dados da OMIE (ACUM/INDICADORES)...
   - ‚ÑπÔ∏è [OMIE] A tentar extrair dados recentes (ACUM, INDICADORES)...
     - [OMIE] A ler dados (ACUM)...
     - [OMIE] A ler dados (INDICADORES)...
   - ‚úÖ [OMIE] 288 registos recentes extra√≠dos.

   - 4: A combinar e limpar dados...

‚úÖ SUCESSO: 'data/MIBEL_ano_atual_ACUM.csv' foi atualizado com sucesso.
   - Total de registos guardados: 30912
=== FASE 1 (MIBEL CSV) TERMINADA: Mon Nov 17 13:30:45 UTC 2025 ===
=== FASE 2 (AUTOCONSUMO) IGNORADA (Sem Mudan√ßas na Fase 1): Mon Nov 17 13:30:45 UTC 2025 ===
=== FASE 1 (MIBEL CSV) INICIADA: Mon Nov 17 14:45:28 UTC 2025 ===
‚úÖ Bibliotecas carregadas para [Atualizador de MIBEL_ano_atual_ACUM]
üöÄ A iniciar a atualiza√ß√£o do ficheiro hist√≥rico `MIBEL_atual_ACUM.csv`...

   - 1: A ler hist√≥rico local...
     - ‚úÖ 'data/MIBEL_ano_atual_ACUM.csv' lido com sucesso (30912 registos).

   - 2: √öltima data local: 2025-11-18. A preencher buracos com OMIE Di√°rio desde 2025-11-19...
   - ‚ÑπÔ∏è O hist√≥rico local j√° est√° atualizado. A saltar OMIE Di√°rio.

   - 3: A obter dados da OMIE (ACUM/INDICADORES)...
   - ‚ÑπÔ∏è [OMIE] A tentar extrair dados recentes (ACUM, INDICADORES)...
     - [OMIE] A ler dados (ACUM)...
     - [OMIE] A ler dados (INDICADORES)...
   - ‚úÖ [OMIE] 288 registos recentes extra√≠dos.

   - 4: A combinar e limpar dados...

‚úÖ SUCESSO: 'data/MIBEL_ano_atual_ACUM.csv' foi atualizado com sucesso.
   - Total de registos guardados: 30912
=== FASE 1 (MIBEL CSV) TERMINADA: Mon Nov 17 14:45:30 UTC 2025 ===
=== FASE 2 (AUTOCONSUMO) IGNORADA (Sem Mudan√ßas na Fase 1): Mon Nov 17 14:45:30 UTC 2025 ===
=== FASE 1 (MIBEL CSV) INICIADA: Tue Nov 18 13:25:25 UTC 2025 ===

üîµ üöÄ A iniciar atualiza√ß√£o MIBEL

üîµ [LIVE] A extrair dados ACUM + INDICADORES
       ‚Ä¢ [ACUM] A descarregar‚Ä¶
       ‚Ä¢ [ACUM] OK (35137 registos)
       ‚Ä¢ [INDICADORES] A descarregar‚Ä¶
       ‚Ä¢ [INDICADORES] OK, dia 2025-11-19 (96 registos)

üîµ [PLANO A] ACUM v√°lido ‚Äî usar como base
   - √öltima data na base: 2025-11-19
   - INDICADORES dispon√≠vel para: 2025-11-19

üîµ [FINAL] A combinar e guardar
   - üíæ Backup criado.
   - ‚úÖ Atualiza√ß√£o conclu√≠da: 35137 registos
   - üèÅ FIM
=== FASE 1 (MIBEL CSV) TERMINADA: Tue Nov 18 13:25:27 UTC 2025 ===
=== FASE 2 (AUTOCONSUMO) INICIADA (Houve Mudan√ßas): Tue Nov 18 13:25:28 UTC 2025 ===
‚úÖ Bibliotecas carregadas
‚ÑπÔ∏è Fonte de dados: 'data/MIBEL_ano_atual_ACUM.csv'
‚ö†Ô∏è MODO: Apenas dados reais (sem futuros)

‚è≥ Passo 1: A ler dados hist√≥ricos do 'data/MIBEL_ano_atual_ACUM.csv'...
‚úÖ 35137 registos hist√≥ricos (com dados) lidos.
   üìÖ √öltima data com dados: 2025-11-19

‚è≥ Passo 2: A criar estrutura completa at√© 2026...
   - Dados reais at√©: 2025-11-19
   - Estrutura criada at√©: 2025-12-31
   - Registos com dados reais: 35137
   - Registos vazios (futuros): 4032

‚è≥ Passo 3: A converter para hora de Portugal...
‚úÖ 35036 registos totais preparados em hora de Portugal.
   - Com dados reais: 31004
   - Vazios (NaN): 4032
‚úÖ Todos os dias t√™m n√∫mero de quartos esperado (92, 96 ou 100).

‚è≥ Passo 4: A atualizar o ficheiro 'Simulador_‚òÄÔ∏è_Autoconsumo_Tiago_Felicia.xlsx'...
   - A ler a pauta de tempo da aba 'OMIE_CICLOS' para alinhamento...
   - A alinhar pre√ßos calculados com a pauta do Excel...
   - 35036 pre√ßos (2025/2026) alinhados e prontos a escrever.
   - A carregar 'Simulador_‚òÄÔ∏è_Autoconsumo_Tiago_Felicia.xlsx' para escrita...
   - A escrever 35036 pre√ßos na Coluna 8 (H)...
‚úÖ O ficheiro Excel foi atualizado com sucesso!
   Data_Valores_OMIE = 2025-11-19
   ‚ö†Ô∏è Nota: Apenas dados reais at√© 2025-11-19 foram escritos.
=== FASE 2 (AUTOCONSUMO) TERMINADA: Tue Nov 18 13:25:57 UTC 2025 ===
=== FASE 1 (MIBEL CSV) INICIADA: Wed Nov 19 10:07:03 UTC 2025 ===

üîµ üöÄ A iniciar atualiza√ß√£o MIBEL

üîµ [LIVE] A extrair dados ACUM + INDICADORES
       ‚Ä¢ [ACUM] A descarregar‚Ä¶
       ‚Ä¢ [ACUM] OK (35137 registos)
       ‚Ä¢ [ACUM] Intervalo temporal: 2024-11-18 ‚Üí 2025-11-19
       ‚Ä¢ [INDICADORES] A descarregar‚Ä¶
       ‚Ä¢ [INDICADORES] OK, dia 2025-11-19 (96 registos)

üîµ [PLANO A] ACUM v√°lido ‚Äî usar como base
   - √öltima data na base: 2025-11-19
   - INDICADORES dispon√≠vel para: 2025-11-19

üîµ [FINAL] A combinar e guardar
   - üíæ Backup criado.
   - ‚úÖ Atualiza√ß√£o conclu√≠da: 35137 registos
   - üèÅ FIM
=== FASE 1 (MIBEL CSV) TERMINADA: Wed Nov 19 10:07:06 UTC 2025 ===
=== FASE 2 (AUTOCONSUMO) IGNORADA (Sem Mudan√ßas na Fase 1): Wed Nov 19 10:07:06 UTC 2025 ===
